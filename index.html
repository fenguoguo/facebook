这是我修改的完善的功能
